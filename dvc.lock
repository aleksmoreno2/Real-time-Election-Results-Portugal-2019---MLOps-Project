schema: '2.0'
stages:
  data_prepare:
    cmd: python -m src.stages.data_prepare --config=params.yaml
    deps:
    - path: src/stages/data_prepare.py
      hash: md5
      md5: 39b631db49be4d2fe839ca575a48e62e
      size: 1102
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data_load:
          dataset_csv: data/ElectionData.csv
          dataset_prepare: data/processed/ElectionData_prepared.csv
    outs:
    - path: data/processed/ElectionData_prepared.csv
      hash: md5
      md5: b52e84cd75f89c11276c8738ea41491f
      size: 3218913
  featurize:
    cmd: python -m src.stages.featurize --config=params.yaml
    deps:
    - path: data/processed/ElectionData_prepared.csv
      hash: md5
      md5: b52e84cd75f89c11276c8738ea41491f
      size: 3218913
    - path: src/stages/featurize.py
      hash: md5
      md5: d1b9688c979976b5c671dfbc8ef0981f
      size: 3340
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data_load:
          dataset_csv: data/ElectionData.csv
          dataset_prepare: data/processed/ElectionData_prepared.csv
        featurize:
          features_path: data/processed/ElectionData_featured.csv
          cols_to_drop:
          - time
          corr_vars1:
          - totalMandates
          - numParishesApproved
          - blankVotes
          - nullVotes
          - subscribedVoters
          - totalVoters
          - pre.blankVotes
          - pre.nullVotes
          - pre.subscribedVoters
          - pre.totalVoters
          - Percentage
          - Mandates
          - pre.blankVotesPercentage
          - pre.votersPercentage
          corr_vars2:
          - Votes
          - Hondt
          categorical_vars:
          - territoryName
          - Party
    outs:
    - path: data/processed/ElectionData_featured.csv
      hash: md5
      md5: 42dfcb2acaf2217311aa66ebc4be3ff1
      size: 5335417
  data_split:
    cmd: python -m src.stages.data_split --config=params.yaml
    deps:
    - path: data/processed/ElectionData_featured.csv
      hash: md5
      md5: 42dfcb2acaf2217311aa66ebc4be3ff1
      size: 5335417
    - path: src/stages/data_split.py
      hash: md5
      md5: 878d742826b519ae4323797fe172a262
      size: 1340
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data_load:
          dataset_csv: data/ElectionData.csv
          dataset_prepare: data/processed/ElectionData_prepared.csv
        data_split:
          test_size: 0.3
          trainset_path: data/processed/train_Elections.csv
          testset_path: data/processed/test_Elections.csv
        featurize:
          features_path: data/processed/ElectionData_featured.csv
          cols_to_drop:
          - time
          corr_vars1:
          - totalMandates
          - numParishesApproved
          - blankVotes
          - nullVotes
          - subscribedVoters
          - totalVoters
          - pre.blankVotes
          - pre.nullVotes
          - pre.subscribedVoters
          - pre.totalVoters
          - Percentage
          - Mandates
          - pre.blankVotesPercentage
          - pre.votersPercentage
          corr_vars2:
          - Votes
          - Hondt
          categorical_vars:
          - territoryName
          - Party
    outs:
    - path: data/processed/test_Elections.csv
      hash: md5
      md5: 383a58d9ffa1ba7b1ec2bbb0e9eb6240
      size: 1595116
    - path: data/processed/train_Elections.csv
      hash: md5
      md5: 0b636bce874cb0bfaa5580fcc208239f
      size: 3720954
  train:
    cmd: python -m src.stages.train --config=params.yaml
    deps:
    - path: data/processed/train_Elections.csv
      hash: md5
      md5: 0b636bce874cb0bfaa5580fcc208239f
      size: 3720954
    - path: src/stages/train.py
      hash: md5
      md5: 7355794d7131871525a45f4df3796015
      size: 2303
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data_split.trainset_path: data/processed/train_Elections.csv
        train:
          target_column: FinalMandates
          estimator_name: RandomForestRegressor
          estimators:
            RandomForestRegressor:
              n_estimators: 300
              max_depth: 10
              max_features: 10
              min_samples_leaf: 4
          model_path: models/model.joblib
    outs:
    - path: models/model.joblib
      hash: md5
      md5: f234e14c2f83388fb7edc42c3ad05007
      size: 4344513
